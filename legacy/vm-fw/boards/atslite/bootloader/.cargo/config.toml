[unstable]
#build-std = ["core"]
#build-std-features = ["panic_immediate_abort"]

[target.'cfg(all(target_arch = "arm", target_os = "none"))']
runner = "probe-rs run --chip nrf5340_xxAA"

rustflags = [
  # Code-size optimizations.
  #"-Z", "trap-unreachable=no",
  #"-C", "no-vectorize-loops",
  "-C", "force-frame-pointers=yes",
]

[build]
target = "thumbv8m.main-none-eabihf"

[env]
DEFMT_LOG = "info"

[patch."https://github.com/Abrahamh08/embassy"]
embassy-usb-dfu = { path = "../../../patch/embassy/embassy-usb-dfu" }
embassy-usb = { path = "../../../patch/embassy/embassy-usb" }
embassy-usb-driver = { path = "../../../patch/embassy/embassy-usb-driver" }
embassy-boot = { path = "../../../patch/embassy/embassy-boot" }
embassy-nrf = { path = "../../../patch/embassy/embassy-nrf" }
embassy-sync = { path = "../../../patch/embassy/embassy-sync" }
embassy-executor = { path = "../../../patch/embassy/embassy-executor" }
embassy-time = { path = "../../../patch/embassy/embassy-time" }
embassy-time-driver = { path = "../../../patch/embassy/embassy-time-driver" }
embassy-futures = { path = "../../../patch/embassy/embassy-futures" }
embassy-embedded-hal = { path = "../../../patch/embassy/embassy-embedded-hal" }
embassy-hal-internal = { path = "../../../patch/embassy/embassy-hal-internal" }
